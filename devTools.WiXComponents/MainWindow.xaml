<Window
	x:Class="devTools.WiXComponents.MainWindow"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:viewModels="clr-namespace:devTools.WiXComponents.Core.ViewModels;assembly=WiXComp.Core"
	mc:Ignorable="d" Title="{Binding Title}" Width="800" Height="600"
	ResizeMode="NoResize" WindowStyle="None" Background="Transparent" AllowsTransparency="True"
	d:DataContext="{d:DesignData MainViewModel}">
	<Border CornerRadius="8" Background="Transparent">
		<Border Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" Margin="8" CornerRadius="8">
			<Border.Effect>
				<DropShadowEffect Direction="270" ShadowDepth="2" BlurRadius="8" Opacity="0.2" />
			</Border.Effect>
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="*" />
				</Grid.RowDefinitions>
				<Border Style="{StaticResource WindowCaption}">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="Auto" />
						</Grid.ColumnDefinitions>
						<Image Grid.Column="0" Source="wixtoolset.ico" HorizontalAlignment="Left" Width="32" Height="32" Margin="16,4,4,4" />
						<TextBlock Grid.Column="1" Text="{Binding Title}" />
						<Button Grid.Column="2" Name="MinimizeButton" Width="28"
								Content="-" Click="MinimizeButton_Click" />
						<Button Grid.Column="3" Name="CloseButton" Width="28" Margin="0, 0, 8, 0" 
								Content="x" Click="CloseButton_Click" />
					</Grid>
				</Border>
				<DockPanel Grid.Row="1" LastChildFill="True">
					<ItemsControl DockPanel.Dock="Top" ItemsSource="{Binding ViewModels}">
						<ItemsControl.ItemsPanel>
							<ItemsPanelTemplate>
								<WrapPanel />
							</ItemsPanelTemplate>
						</ItemsControl.ItemsPanel>
						<ItemsControl.ItemTemplate>
							<DataTemplate DataType="viewModels:ViewModelCommandBase">
								<Button Content="{Binding DisplayName}"
										Command="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}, Path=DataContext.ChangeView}"
										CommandParameter="{Binding}"
										Padding="8" />
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
					<StatusBar DockPanel.Dock="Bottom">
						<StatusBar.ItemsPanel>
							<ItemsPanelTemplate>
								<Grid>
									<Grid.RowDefinitions>
										<RowDefinition Height="*" />
									</Grid.RowDefinitions>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="*" />
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="2*" />
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="100" />
									</Grid.ColumnDefinitions>
								</Grid>
							</ItemsPanelTemplate>
						</StatusBar.ItemsPanel>
						<StatusBarItem>
							<TextBlock Text="{Binding Status}"></TextBlock>
						</StatusBarItem>
						<Separator Grid.Column="1"></Separator>
						<StatusBarItem Grid.Column="2">
							<TextBlock Text="{Binding Operation}"></TextBlock>
						</StatusBarItem>
						<Separator Grid.Column="3"></Separator>
						<StatusBarItem Grid.Column="4">
							<ProgressBar Width="90" Height="18" Value="{Binding Progress, Mode=OneWay}"></ProgressBar>
						</StatusBarItem>
					</StatusBar>
					<ContentControl Margin="16" Content="{Binding SelectedViewModel}" />
				</DockPanel>
			</Grid>
		</Border>
	</Border>
</Window>
